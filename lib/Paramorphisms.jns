assume (0 List : (0 _ : ğ˜œ) â†’ ğ˜œ)
assume (Ï‰ Nil : (0 A : ğ˜œ) â†’ List A)
assume (Ï‰ Cons : âˆ€ (0 A : ğ˜œ) (1 _ : A) (1 _ : List A) . List A)
assume (Ï‰ foldr : âˆ€ (0 A : ğ˜œ)
                    (0 B : ğ˜œ)
                    (Ï‰ f : âˆ€ (1 _ : A) (1 _ : B) . B)
                    (1 z : B)
                    (1 l : List A)
                  . B)

let Ï‰ para = (Î»A B f z l. snd (foldr A ((_ : List A) & B)
                           (Î»a w. âŸ¨Cons A a (fst w), f a wâŸ©)
                           âŸ¨Nil A, zâŸ©
                           l))
             : âˆ€ (0 A : ğ˜œ)
                 (0 B : ğ˜œ)
                 (Ï‰ f : âˆ€ (1 _ : A) (1 _ : (_ : List A) & B) . B)
                 (Ï‰ z : B)
                 (1 l : List A)
               . B

let 0 Pair = (Î»A B. (1 _ : A) âŠ— B) : âˆ€ (0 A : ğ˜œ) (0 B : ğ˜œ) . ğ˜œ

let 0 Bool = ğŸ­â‚˜ âŠ• ğŸ­â‚˜ : ğ˜œ
let Ï‰ true = inl () : Bool
let Ï‰ false = inr () : Bool
let Ï‰ if = (Î»S b p. case 1 _ @ b of { inl x â†’ let 1 _ @ () = x in fst p : S;
                                      inr y â†’ let 1 _ @ () = y in snd p : S
                                    } : S)
           : âˆ€ (0 S : ğ˜œ) (1 b : Bool) (1 p : (_ : S) & S) . S

assume (0 A : ğ˜œ)
assume (Ï‰ leq : (1 _ : Pair A A) â†’ Pair Bool (Pair A A))

let Ï‰ insert = (Î»v l. para A ((1 _ : A) â†’ List A)
                      (Î»x w i. let 1 _ @ (b, xi) = leq (x, i)
                               in let 1 _ @ (x', i') = xi
                                  in if (List A) b
                                     âŸ¨Cons A x' ((snd w) i'), Cons A i' (Cons A x' (fst w))âŸ©
                                  : List A
                               : List A)
                      (Î»i. Cons A i (Nil A))
                      l
                      v)
               : âˆ€ (1 _ : A) (1 _ : List A) . List A

assume (Ï‰ foldr' : âˆ€ (0 A : ğ˜œ)
                     (0 B : (0 _ : List A) â†’ ğ˜œ)
                     (Ï‰ f : âˆ€ (1 x : A) (0 xs : List A) (1 _ : B xs) . B (Cons A x xs))
                     (1 z : B (Nil A))
                     (1 l : List A)
                   . B l)

assume (0 Id : âˆ€ (0 A : ğ˜œ) (0 x : A) (0 y : A) . ğ˜œ)
assume (Ï‰ Refl : âˆ€ (0 A : ğ˜œ) (0 x : A) . Id A x x)
assume (Ï‰ J : âˆ€ (0 A : ğ˜œ)
                (0 x : A)
                (0 B : âˆ€ (0 y : A) (0 _ : Id A x y) . ğ˜œ)
                (1 f : B x (Refl A x))
                (0 y : A)
                (1 p : Id A x y)
              . B y p)

let Ï‰ cong = (Î»A B x y f p. J A x (Î»y _. Id B (f x) (f y)) (Refl B (f x)) y p)
             : âˆ€ (0 A : ğ˜œ)
                 (0 B : ğ˜œ)
                 (0 x : A)
                 (0 y : A)
                 (0 f : (1 _ : A) â†’ B)
                 (1 p : Id A x y)
               . Id B (f x) (f y)

let 0 Triple = (Î»A B l. (1 p : (l' : List A) & B l') âŠ— Id (List A) (fst p) l)
               : âˆ€ (0 A : ğ˜œ) (0 B : (0 _ : List A) â†’ ğ˜œ) (0 _ : List A) . ğ˜œ

let Ï‰ extract = (Î»A B l e. let 1 _ @ (pr, pf) = e
                           in J (List A) (fst pr) (Î»l' _. B l') (snd pr) l pf
                           : B l)
                : âˆ€ (0 A : ğ˜œ)
                    (0 B : (0 _ : List A) â†’ ğ˜œ)
                    (0 l : List A)
                    (1 _ : Triple A B l)
                  . B l

let Ï‰ para' = (Î»A B f z l. extract A
                                   B
                                   l
                                   (foldr' A
                                           (Triple A B)
                                           (Î»x xs p. let 1 _ @ (m, n) = p
                                                     in (âŸ¨Cons A x (fst m)
                                                         , f x mâŸ©
                                                        , cong (List A)
                                                               (List A)
                                                               (fst m)
                                                               xs
                                                               (Cons A x)
                                                               n)
                                                     : (Triple A B (Cons A x xs)))
                                           (âŸ¨Nil A, zâŸ©, Refl (List A) (Nil A))
                                           l))
              : âˆ€ (0 A : ğ˜œ)
                  (0 B : (0 _ : List A) â†’ ğ˜œ)
                  (Ï‰ f : âˆ€ (1 x : A)
                           (1 p : (l : List A) & B l)
                         . B (Cons A x (fst p)))
                  (Ï‰ z : B (Nil A))
                  (1 l : List A)
                . B l
